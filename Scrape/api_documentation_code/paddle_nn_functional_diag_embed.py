import paddle.nn.functional as F
import numpy as np

diag_embed = np.random.randn(2, 3).astype('float32')
# [[ 0.7545889 , -0.25074545,  0.5929117 ],
#  [-0.6097662 , -0.01753256,  0.619769  ]]

data1 = F.diag_embed(diag_embed)
data1.numpy()
# [[[ 0.7545889 ,  0.        ,  0.        ],
#  [ 0.        , -0.25074545,  0.        ],
#   [ 0.        ,  0.        ,  0.5929117 ]],

# [[-0.6097662 ,  0.        ,  0.        ],
#  [ 0.        , -0.01753256,  0.        ],
#  [ 0.        ,  0.        ,  0.619769  ]]]

data2 = F.diag_embed(diag_embed, offset=-1, dim1=0, dim2=2)
data2.numpy()
# [[[ 0.        ,  0.        ,  0.        ,  0.        ],
#   [ 0.7545889 ,  0.        ,  0.        ,  0.        ],
#   [ 0.        , -0.25074545,  0.        ,  0.        ],
#   [ 0.        ,  0.        ,  0.5929117 ,  0.        ]],
#
#  [[ 0.        ,  0.        ,  0.        ,  0.        ],
#   [-0.6097662 ,  0.        ,  0.        ,  0.        ],
#   [ 0.        , -0.01753256,  0.        ,  0.        ],
#   [ 0.        ,  0.        ,  0.619769  ,  0.        ]]]

data3 = F.diag_embed(diag_embed, offset=1, dim1=0, dim2=2)
data3.numpy()
# [[[ 0.        ,  0.7545889 ,  0.        ,  0.        ],
#   [ 0.        , -0.6097662 ,  0.        ,  0.        ]],
#
#  [[ 0.        ,  0.        , -0.25074545,  0.        ],
#   [ 0.        ,  0.        , -0.01753256,  0.        ]],
#
#  [[ 0.        ,  0.        ,  0.        ,  0.5929117 ],
#   [ 0.        ,  0.        ,  0.        ,  0.619769  ]],
#
#  [[ 0.        ,  0.        ,  0.        ,  0.        ],
#   [ 0.        ,  0.        ,  0.        ,  0.        ]]]